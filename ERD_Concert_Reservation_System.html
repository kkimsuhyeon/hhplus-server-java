<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì½˜ì„œíŠ¸ ì˜ˆì•½ ì„œë¹„ìŠ¤ ERD</title>
    <script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #f5f7fa;
            color: #333;
        }
        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 10px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            padding: 30px;
        }
        h1 {
            text-align: center;
            color: #2c3e50;
            margin-bottom: 10px;
            font-size: 2.5em;
        }
        .subtitle {
            text-align: center;
            color: #7f8c8d;
            margin-bottom: 40px;
            font-size: 1.2em;
        }
        .erd-container {
            background: #fff;
            border: 1px solid #e1e8ed;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 40px;
            overflow-x: auto;
        }
        .legend {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 30px;
        }
        .domain {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .domain h3 {
            margin-top: 0;
            font-size: 1.3em;
            border-bottom: 2px solid rgba(255,255,255,0.3);
            padding-bottom: 10px;
        }
        .entity {
            background: rgba(255,255,255,0.1);
            padding: 10px;
            margin: 10px 0;
            border-radius: 5px;
            border-left: 4px solid #f39c12;
        }
        .entity h4 {
            margin: 0 0 8px 0;
            font-size: 1.1em;
        }
        .entity-field {
            font-size: 0.9em;
            margin: 2px 0;
            opacity: 0.9;
        }
        .pk {
            color: #e74c3c;
            font-weight: bold;
        }
        .fk {
            color: #3498db;
            font-weight: bold;
        }
        .stats {
            display: flex;
            justify-content: space-around;
            background: #ecf0f1;
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
        }
        .stat {
            text-align: center;
        }
        .stat-number {
            font-size: 2em;
            font-weight: bold;
            color: #3498db;
        }
        .stat-label {
            color: #7f8c8d;
            font-size: 0.9em;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸµ ì½˜ì„œíŠ¸ ì˜ˆì•½ ì„œë¹„ìŠ¤</h1>
        <p class="subtitle">Entity Relationship Diagram (ERD)</p>
        
        <div class="stats">
            <div class="stat">
                <div class="stat-number">7</div>
                <div class="stat-label">Total Entities</div>
            </div>
            <div class="stat">
                <div class="stat-number">4</div>
                <div class="stat-label">Domains</div>
            </div>
            <div class="stat">
                <div class="stat-number">8</div>
                <div class="stat-label">Relationships</div>
            </div>
        </div>
        
        <div class="erd-container">
            <div class="mermaid">
erDiagram
    %% ì½˜ì„œíŠ¸ ë„ë©”ì¸
    CONCERT {
        string concert_id PK "ì½˜ì„œíŠ¸ ID"
        string title "ì½˜ì„œíŠ¸ ì œëª©"
        string description "ì½˜ì„œíŠ¸ ì„¤ëª…"
        datetime created_at "ë“±ë¡ ì¼ì‹œ"
        datetime updated_at "ìˆ˜ì • ì¼ì‹œ"
    }
    
    CONCERT_SCHEDULE {
        string concert_schedule_id PK "ì½˜ì„œíŠ¸ ìŠ¤ì¼€ì¤„ ID"
        string concert_id FK "ì½˜ì„œíŠ¸ ID"
        datetime created_at "ë“±ë¡ ì¼ì‹œ"
        datetime updated_at "ìˆ˜ì • ì¼ì‹œ"
    }
    
    SEAT {
        string seat_id PK "ì¢Œì„ ID"
        int seat_number "ì¢Œì„ ë²ˆí˜¸ (1-50)"
        enum status "ì¢Œì„ ìƒíƒœ (AVAILABLE/RESERVING/RESERVED)"
        long price "ê°€ê²©"
        string schedule_id FK "ìŠ¤ì¼€ì¤„ ID"
        string user_id FK "ì‚¬ìš©ì ID (ì„ì‹œë°°ì •)"
    }
    
    %% ì‚¬ìš©ì ë„ë©”ì¸
    USER {
        string user_id PK "ì‚¬ìš©ì ID"
        long balance "ì”ì•¡"
    }
    
    %% ì˜ˆì•½ ë„ë©”ì¸
    RESERVATION {
        string reservation_id PK "ì˜ˆì•½ ID"
        enum status "ì˜ˆì•½ ìƒíƒœ"
        datetime expired_at "ì˜ˆì•½ ë§Œë£Œ ì‹œê°„"
        string user_id FK "ì‚¬ìš©ì ID"
        string schedule_id FK "ìŠ¤ì¼€ì¤„ ID"
        string seat_id FK "ì¢Œì„ ID"
    }
    
    %% ê²°ì œ ë„ë©”ì¸
    PAYMENT {
        string payment_id PK "ê²°ì œ ID"
        enum status "ê²°ì œ ìƒíƒœ (SUCCESS/FAIL/CANCEL)"
        long amount "ê²°ì œ ê¸ˆì•¡"
        string reservation_id FK "ì˜ˆì•½ ID"
    }
    
    PAYMENT_HISTORY {
        long payment_history_id PK "ê²°ì œ ì´ë ¥ ID"
        enum status "ê²°ì œ ìƒíƒœ"
        long amount "ê²°ì œ ê¸ˆì•¡"
        string payment_id FK "ê²°ì œ ID"
        string user_id FK "ì‚¬ìš©ì ID"
    }
    
    %% ê´€ê³„ ì •ì˜
    CONCERT ||--o{ CONCERT_SCHEDULE : "has schedules"
    CONCERT_SCHEDULE ||--o{ SEAT : "contains seats"
    USER ||--o{ SEAT : "temporarily assigned"
    USER ||--o{ RESERVATION : "makes reservation"
    USER ||--o{ PAYMENT_HISTORY : "payment history"
    CONCERT_SCHEDULE ||--o{ RESERVATION : "scheduled for"
    SEAT ||--|| RESERVATION : "reserved by"
    RESERVATION ||--|| PAYMENT : "paid by"
    PAYMENT ||--o{ PAYMENT_HISTORY : "history tracks"
            </div>
        </div>

        <div class="legend">
            <div class="domain" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">
                <h3>ğŸµ ì½˜ì„œíŠ¸ ë„ë©”ì¸</h3>
                <div class="entity">
                    <h4>CONCERT</h4>
                    <div class="entity-field"><span class="pk">concert_id</span> (PK) - ì½˜ì„œíŠ¸ ID</div>
                    <div class="entity-field">title - ì½˜ì„œíŠ¸ ì œëª©</div>
                    <div class="entity-field">description - ì½˜ì„œíŠ¸ ì„¤ëª…</div>
                    <div class="entity-field">created_at, updated_at - ì‹œê°„ ì •ë³´</div>
                </div>
                <div class="entity">
                    <h4>CONCERT_SCHEDULE</h4>
                    <div class="entity-field"><span class="pk">concert_schedule_id</span> (PK) - ìŠ¤ì¼€ì¤„ ID</div>
                    <div class="entity-field"><span class="fk">concert_id</span> (FK) - ì½˜ì„œíŠ¸ ID</div>
                    <div class="entity-field">created_at, updated_at - ì‹œê°„ ì •ë³´</div>
                </div>
                <div class="entity">
                    <h4>SEAT</h4>
                    <div class="entity-field"><span class="pk">seat_id</span> (PK) - ì¢Œì„ ID</div>
                    <div class="entity-field">seat_number - ì¢Œì„ ë²ˆí˜¸ (1-50)</div>
                    <div class="entity-field">status - ì¢Œì„ ìƒíƒœ (AVAILABLE/RESERVING/RESERVED)</div>
                    <div class="entity-field">price - ê°€ê²©</div>
                    <div class="entity-field"><span class="fk">schedule_id, user_id</span> (FK) - ê´€ê³„</div>
                </div>
            </div>

            <div class="domain" style="background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);">
                <h3>ğŸ‘¤ ì‚¬ìš©ì ë„ë©”ì¸</h3>
                <div class="entity">
                    <h4>USER</h4>
                    <div class="entity-field"><span class="pk">user_id</span> (PK) - ì‚¬ìš©ì ID</div>
                    <div class="entity-field">balance - ì”ì•¡</div>
                </div>
            </div>

            <div class="domain" style="background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);">
                <h3>ğŸ“‹ ì˜ˆì•½ ë„ë©”ì¸</h3>
                <div class="entity">
                    <h4>RESERVATION</h4>
                    <div class="entity-field"><span class="pk">reservation_id</span> (PK) - ì˜ˆì•½ ID</div>
                    <div class="entity-field">status - ì˜ˆì•½ ìƒíƒœ</div>
                    <div class="entity-field">expired_at - ì˜ˆì•½ ë§Œë£Œ ì‹œê°„</div>
                    <div class="entity-field"><span class="fk">user_id, schedule_id, seat_id</span> (FK) - ê´€ê³„</div>
                </div>
            </div>

            <div class="domain" style="background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%);">
                <h3>ğŸ’³ ê²°ì œ ë„ë©”ì¸</h3>
                <div class="entity">
                    <h4>PAYMENT</h4>
                    <div class="entity-field"><span class="pk">payment_id</span> (PK) - ê²°ì œ ID</div>
                    <div class="entity-field">status - ê²°ì œ ìƒíƒœ (SUCCESS/FAIL/CANCEL)</div>
                    <div class="entity-field">amount - ê²°ì œ ê¸ˆì•¡</div>
                    <div class="entity-field"><span class="fk">reservation_id</span> (FK) - ì˜ˆì•½ ID</div>
                </div>
                <div class="entity">
                    <h4>PAYMENT_HISTORY</h4>
                    <div class="entity-field"><span class="pk">payment_history_id</span> (PK) - ì´ë ¥ ID</div>
                    <div class="entity-field">status - ê²°ì œ ìƒíƒœ</div>
                    <div class="entity-field">amount - ê²°ì œ ê¸ˆì•¡</div>
                    <div class="entity-field"><span class="fk">payment_id, user_id</span> (FK) - ê´€ê³„</div>
                </div>
            </div>
        </div>


        <div style="text-align: center; color: #7f8c8d; font-size: 0.9em; margin-top: 40px; padding-top: 20px; border-top: 1px solid #ecf0f1;">
            Generated on: <script>document.write(new Date().toLocaleString('ko-KR'))</script><br>
            Project: HangHae Plus Concert Reservation System
        </div>
    </div>

    <script>
        mermaid.initialize({ 
            startOnLoad: true,
            theme: 'default',
            themeVariables: {
                primaryColor: '#667eea',
                primaryTextColor: '#2c3e50',
                primaryBorderColor: '#667eea',
                lineColor: '#95a5a6',
                secondaryColor: '#ecf0f1',
                tertiaryColor: '#fff'
            }
        });
    </script>
</body>
</html>